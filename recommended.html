<!DOCTYPE html>
<html lang="en">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />

    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Hydra - Recommended Sources</title>

    <link rel="icon" type="image/png" href="img/solaris-icon.png" />
    <link rel="apple-touch-icon" href="img/solaris-icon.png" />

    <link rel="preconnect" href="https://fonts.googleapis.com/" />
    <link rel="preconnect" href="https://fonts.gstatic.com/" crossorigin />
    <link href="./Kazumi Fonte_files/css2" rel="stylesheet" />
    <link
      rel="stylesheet"
      href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css"
    />
    <script
      defer
      src="./Kazumi Fonte_files/beacon.min.js.baixados"
      data-cf-beacon='{"token": "d5d0b711e5b740ca8c8e048cb3b29384"}'
    ></script>
    <style>
      * {
        margin: 0;
        padding: 0;
        box-sizing: border-box;
        font-family: "Montserrat";
      }

      body {
        background-image: linear-gradient(
          230deg,
          #23262f,
          #1f2129,
          #1d1f26,
          #1b1d23,
          #16191d,
          #141619,
          #121417 60%,
          #101114 70% 80%,
          #0d0f11 90%,
          #0b0c0e
        );
        color: #ffffff;
        text-align: center;
        min-height: 100vh;
        display: flex;
        flex-direction: column;
        justify-content: space-between;
      }

      /* ===== UPDATE BAR STYLES ===== */
      .update-bar {
        background: linear-gradient(
          90deg,
          #6a1b9a 0%,
          #9c27b0 50%,
          #6a1b9a 100%
        );
        color: white;
        padding: 12px 0;
        overflow: hidden;
        position: relative;
        box-shadow: 0 2px 10px rgba(0, 0, 0, 0.3);
      }

      .update-bar-content {
        display: flex;
        align-items: center;
        justify-content: center;
        gap: 30px;
        animation: slideIn 0.5s ease-out;
      }

      @keyframes slideIn {
        from {
          opacity: 0;
          transform: translateY(-20px);
        }
        to {
          opacity: 1;
          transform: translateY(0);
        }
      }

      .update-bar-title {
        font-weight: 700;
        font-size: 0.95rem;
        text-transform: uppercase;
        letter-spacing: 1px;
        display: flex;
        align-items: center;
        gap: 8px;
      }

      .update-pulse {
        width: 8px;
        height: 8px;
        background: #14f195;
        border-radius: 50%;
        animation: pulse 2s infinite;
      }

      @keyframes pulse {
        0%,
        100% {
          opacity: 1;
          transform: scale(1);
        }
        50% {
          opacity: 0.5;
          transform: scale(1.3);
        }
      }

      .update-games {
        display: flex;
        gap: 20px;
        flex-wrap: wrap;
        justify-content: center;
        align-items: center;
      }

      .update-game-item {
        display: flex;
        align-items: center;
        gap: 8px;
        background: rgba(255, 255, 255, 0.1);
        padding: 6px 14px;
        border-radius: 20px;
        font-size: 0.85rem;
        transition: all 0.3s;
        backdrop-filter: blur(5px);
      }

      .update-game-item:hover {
        background: rgba(255, 255, 255, 0.2);
        transform: translateY(-2px);
      }

      .update-game-name {
        font-weight: 600;
        max-width: 250px;
        overflow: hidden;
        text-overflow: ellipsis;
        white-space: nowrap;
      }

      .update-game-date {
        font-size: 0.75rem;
        opacity: 0.85;
        font-weight: 500;
      }

      .update-bar-loading {
        text-align: center;
        font-size: 0.9rem;
        opacity: 0.9;
      }

      .update-bar-error {
        background: linear-gradient(
          90deg,
          #d32f2f 0%,
          #f44336 50%,
          #d32f2f 100%
        );
      }

      .update-separator {
        width: 2px;
        height: 20px;
        background: rgba(255, 255, 255, 0.3);
      }

      /* Responsive */
      @media (max-width: 768px) {
        .update-bar {
          padding: 10px 15px;
        }

        .update-bar-content {
          flex-direction: column;
          gap: 10px;
        }

        .update-games {
          gap: 8px;
        }

        .update-game-item {
          font-size: 0.8rem;
          padding: 5px 10px;
        }

        .update-game-name {
          max-width: 150px;
        }
      }

      /* ===== SOCIAL ICONS STYLES (Novo) ===== */
      .social-icons {
        position: fixed;
        top: 20px;
        left: 20px;
        z-index: 1000;
        display: flex;
        gap: 15px;
      }

      .social-icon {
        color: #a3a9ff;
        font-size: 1.5rem;
        transition: color 0.3s, transform 0.2s;
      }

      .social-icon:hover {
        color: #8b96ff;
        transform: scale(1.1);
      }
      /* Fim SOCIAL ICONS STYLES */

      /* ===== RECOMMENDED SOURCES BUTTON STYLES (Novo) ===== */
      .recommended-sources {
        position: fixed;
        bottom: 20px;
        left: 20px;
        z-index: 1000;
      }

      .recommended-sources a {
        background-color: #3b3f4b;
        color: #ffffff;
        border: none;
        padding: 12px 24px;
        font-size: 1rem;
        cursor: pointer;
        border-radius: 8px;
        transition: transform 0.2s, background-color 0.3s;
        text-decoration: none;
        display: inline-flex;
        align-items: center;
        gap: 8px;
        font-weight: 600;
        box-shadow: 0 4px 12px rgba(0, 0, 0, 0.4);
      }

      .recommended-sources a:hover {
        background-color: #505360;
        transform: scale(1.05);
      }

      /* Responsividade para o botão */
      @media (max-width: 768px) {
        .recommended-sources {
          bottom: 15px;
          left: 15px;
        }
        .recommended-sources a {
          padding: 10px 18px;
          font-size: 0.9rem;
        }
      }
      /* Fim RECOMMENDED SOURCES BUTTON STYLES */

      header {
        padding-top: 80px;
        font-size: 2.5rem;
        font-weight: 800;
        letter-spacing: 1px;
      }

      .content {
        margin: 10px 0px 35px 0px;
        display: flex;
        justify-content: center;
        gap: 20px;
        flex-wrap: wrap;
      }

      .content button {
        background-color: #3b3f4b;
        color: #ffffff;
        border: none;
        padding: 15px 30px;
        font-size: 1.1rem;
        cursor: pointer;
        border-radius: 8px;
        transition: transform 0.2s, background-color 0.3s;
      }

      .content button:hover {
        background-color: #505360;
        transform: scale(1.05);
      }

      .info {
        max-width: 800px;
        margin: 0 auto 40px;
        padding: 20px;
        background-color: rgba(34, 36, 43, 0.9);
        border-radius: 10px;
        box-shadow: 0px 4px 6px rgba(0, 0, 0, 0.5);
        line-height: 1.6;
        text-align: justify;
      }

      .info h3 {
        text-align: left;
        margin-bottom: 10px;
        font-size: 1.2rem;
        font-weight: 700;
      }

      .info p {
        margin-bottom: 15px;
        word-spacing: -0.05rem;
        text-align: left;
        font-weight: 500;
      }

      footer {
        padding: 15px;
        font-size: 0.9rem;
        color: #aaaaaa;
      }

      a:-webkit-any-link {
        color: #a3a9ff;
      }

      .language-selector {
        position: fixed;
        top: 20px;
        right: 20px;
        z-index: 1000;
        display: flex;
        gap: 10px;
      }

      .lang-btn {
        background: rgba(59, 63, 75, 0.8);
        color: white;
        border: none;
        padding: 8px 12px;
        border-radius: 5px;
        cursor: pointer;
        font-size: 0.9rem;
        transition: all 0.3s;
      }

      .lang-btn.active {
        background: #a3a9ff;
        color: #23262f;
      }

      .lang-btn:hover {
        background: #505360;
      }

      .lang-btn.active:hover {
        background: #8b96ff;
      }
    </style>
  </head>
  <body>
    <div class="social-icons">
      <a
        href="https://github.com/SolarisTM/Hydra-Sources"
        target="_blank"
        class="social-icon"
        title="GitHub"
      >
        <i class="fab fa-github"></i>
      </a>
      <a
        href="https://t.me/solaristm"
        target="_blank"
        class="social-icon"
        title="Telegram"
      >
        <i class="fab fa-telegram-plane"></i>
      </a>
      <a
        href="https://discord.com/invite/CfnU5NpkAA"
        target="_blank"
        class="social-icon"
        title="Discord"
      >
        <i class="fab fa-discord"></i>
      </a>
    </div>

    <div class="recommended-sources">
      <a href="index.html">
        <i class="fas fa-home"></i>
        <span
          data-text-pt="Solaris Sources"
          data-text-en="Solaris Sources"
          >Solaris Sources</span
        >
      </a>
    </div>
    <div id="updateBar" class="update-bar" style="display: none">
      <div class="update-bar-content">
        <div class="update-bar-loading">
          <span
            data-text-pt="Carregando atualizações..."
            data-text-en="Loading updates..."
            >Loading updates...</span
          >
        </div>
      </div>
    </div>

    <div class="language-selector">
      <button class="lang-btn" id="btn-pt">PT</button>
      <button class="lang-btn active" id="btn-en">EN</button>
    </div>

    <header id="title">Hydra - Recommended Sources</header>

    <div class="content">
      <button
        id="addBtn"
        onclick="abrirHydra()"
        data-text-pt="Online-Fix - Instalar Fonte"
        data-text-en="Online-Fix - Install Source"
      >
        Online-Fix - Install Source
      </button>
      <button
        id="addBtn"
        onclick="abrirHydraVR()"
        data-text-pt="Xatab - Instalar Fonte"
        data-text-en="Xatab - Install Source"
      >
        Xatab - Install Source
      </button>
      <button
        id="addBtn"
        onclick="abrirHydraFitGirl()"
        data-text-pt="FitGirl - Instalar Fonte"
        data-text-en="FitGirl - Install Source"
      >
        FitGirl - Install Source
      </button>
      <button
        id="addBtn"
        onclick="abrirHydraSteamRIP()"
        data-text-pt="SteamRIP - Instalar Fonte"
        data-text-en="SteamRIP - Install Source"
      >
        SteamRIP - Install Source
      </button>
      <button
        id="addBtn"
        onclick="pedidopraFonte()"
        data-text-pt="GOG - Instalar Fonte"
        data-text-en="GOG - Install Source"
      >
        GOG - Install Source
      </button>
      <button
        id="addBtn"
        onclick="window.open('https://ko-fi.com/solaristm', '_blank')"
        data-text-pt="Apoie via Ko-Fi"
        data-text-en="Support via Ko-Fi"
      >
        Support via Ko-Fi
      </button>
      </div>

    <div class="info">
      <h3 id="fonteHeader" data-text-pt="Sobre" data-text-en="About">About</h3>
      <p
        id="fonteInfo"
        data-text-pt="As fontes aqui recomendadas são aquelas que a comunidade do CSRIN e do FMHY aprovam para download, muitos deles sendo Repackers conhecidos e com muito tempo em atividade."
        data-text-en="The sources recommended here are those approved for download by the CSRIN and FMHY communities, many of them being well-known and long-established repackers."
      >
        The sources recommended here are those approved for download by the CSRIN and FMHY communities, many of them being well-known and long-established repackers.
      </p>
      <h3 id="linkHeader" data-text-pt="Links" data-text-en="Links">Links</h3>
      <p
        id="linkInfo"
        data-text-pt="Pelo Hydra você terá os arquivos vindo direto do site deles."
        data-text-en="With Hydra, you'll get the files directly from their website."
      >
        With Hydra, you'll get the files directly from their website.
      </p>
      <h3 id="donateHeader" data-text-pt="Doação" data-text-en="Donation">
        Donation
      </h3>
      <p
        id="donateInfo"
        data-text-pt="Sinta-se livre para ajudar este projeto caso goste do meu trabalho, qualquer montante é muito bem vindo e ajuda a manter essas fontes ativas com mais arquivos e pedidos da comunidade!"
        data-text-en="Feel free to help this project if you like my work, any amount is very welcome and helps to keep these sources active with more files and requests from the community!"
      >
        Feel free to help this project if you like my work, any amount is very
        welcome and helps to keep these sources active with more files and requests from the community!
      </p>

      <footer
        id="footer"
        data-text-pt="© 2025 Solaris (Baseado no HTML criado por Shisuys e Kazumi, créditos para eles)."
        data-text-en="© 2025 Solaris (Based on HTML created by Shisuys and Kazumi, credits to them)."
      >
        © 2025 Solaris (Based on HTML created by Shisuys and Kazumi, credits to
        them).
      </footer>
    </div>

    <script src="./Kazumi Fonte_files/qrcode.min.js.baixados"></script>

    <script>
      let currentLanguage = "pt";

      // ===== UPDATE BAR FUNCTIONALITY =====
      const DAYS_TO_SHOW = 0; // Show only today's games (0 = today only)

      async function loadRecentUpdates() {
        const updateBar = document.getElementById("updateBar");

        try {
          // Add cache-busting parameter to always get fresh data
          const cacheBuster = new Date().getTime();
          // *** IMPORTANTE: Mude este URL para o seu arquivo .json no seu GitHub Pages! ***
          const response = await fetch(
            `https://raw.githubusercontent.com/SolarisTM/Hydra-Sources/refs/heads/main/Solaris-Main.json?t=${cacheBuster}`
          );

          if (!response.ok) {
            throw new Error(`HTTP error! status: ${response.status}`);
          }

          const data = await response.json();

          // Get today's date (ignoring time)
          const now = new Date();
          const todayDate = now.toISOString().split("T")[0]; // Format: YYYY-MM-DD

          console.log("Looking for games uploaded on:", todayDate);

          // Filter and process games - only from TODAY
          const recentGames = data.downloads
            .filter((game) => {
              const uploadDate = new Date(game.uploadDate);
              const uploadDateStr = uploadDate.toISOString().split("T")[0];
              const isToday = uploadDateStr === todayDate;

              if (isToday) {
                console.log("Found today's game:", game.title);
              }

              return isToday;
            })
            .map((game) => {
              // Extract game name before first (
              let cleanName = game.title.split("(")[0].trim();
              // Remove common tags like [Pre-Instalado], [FitGirl], etc
              cleanName = cleanName.replace(/\[.*?\]/g, "").trim();
              // Remove trailing dashes or special characters
              cleanName = cleanName.replace(/[-–—]\s*$/, "").trim();

              return {
                name: cleanName,
                uploadDate: new Date(game.uploadDate),
                fileSize: game.fileSize,
              };
            })
            .sort((a, b) => b.uploadDate - a.uploadDate) // Most recent first
            .slice(0, 5); // Only keep the 5 most recent games

          console.log(
            `Found ${
              data.downloads.filter((game) => {
                const uploadDate = new Date(game.uploadDate);
                const uploadDateStr = uploadDate.toISOString().split("T")[0];
                return uploadDateStr === todayDate;
              }).length
            } games uploaded today, showing the 5 most recent`
          );
          console.log("Today's games:", recentGames);

          renderUpdateBar(recentGames);
        } catch (err) {
          console.error("Error fetching updates:", err);
          // Hide the update bar on error instead of showing error message
          updateBar.style.display = "none";
        }
      }

      function formatDateRelative(date) {
        const today = new Date();
        today.setHours(0, 0, 0, 0);
        const compareDate = new Date(date);
        compareDate.setHours(0, 0, 0, 0);

        const diffTime = today - compareDate;
        const diffDays = Math.floor(diffTime / (1000 * 60 * 60 * 24));

        if (currentLanguage === "pt") {
          if (diffDays === 0) return "Hoje";
          if (diffDays === 1) return "Ontem";
          if (diffDays < 7) return `${diffDays} dias atrás`;
          return date.toLocaleDateString("pt-BR");
        } else {
          if (diffDays === 0) return "Today";
          if (diffDays === 1) return "Yesterday";
          if (diffDays < 7) return `${diffDays} days ago`;
          return date.toLocaleDateString("en-US");
        }
      }

      function renderUpdateBar(games) {
        const updateBar = document.getElementById("updateBar");

        if (games.length === 0) {
          updateBar.style.display = "none";
          console.log("No games uploaded today - update bar hidden");
          return;
        }

        updateBar.style.display = "block";
        updateBar.classList.remove("update-bar-error");

        const displayGames = games;
        const titleText = currentLanguage === "pt" ? "Novos Hoje" : "New Today";

        updateBar.innerHTML = `
    <div class="update-bar-content">
      <div class="update-bar-title">
        <div class="update-pulse"></div>
        <span>${titleText}:</span>
      </div>
            <div class="update-separator"></div>
            <div class="update-games">
              ${displayGames
                .map(
                  (game) => `
                <div class="update-game-item">
                  <span class="update-game-name" title="${game.name}">${
                    game.name
                  }</span>
                  <span class="update-game-date">(${formatDateRelative(
                    game.uploadDate
                  )})</span>
                </div>
              `
                )
                .join("")}
            </div>
          </div>
        `;
      }

      function renderUpdateBarError() {
        const updateBar = document.getElementById("updateBar");
        const errorText =
          currentLanguage === "pt"
            ? "Erro ao carregar atualizações"
            : "Error loading updates";

        updateBar.style.display = "block";
        updateBar.classList.add("update-bar-error");
        updateBar.innerHTML = `
          <div class="update-bar-content">
            <div class="update-bar-loading">${errorText}</div>
          </div>
        `;

        console.error("Failed to load update bar");
      }

      // Traduções
      const translations = {
        pt: {
          copySuccess: "Link Copiado!",
          copySuccessVR: "Link Copiado!",
        },
        en: {
          copySuccess: "Link Copied!",
          copySuccessVR: "Link Copied!",
        },
      };

      // Detecção automática de região/idioma
      function detectLanguage() {
        const savedLang = window.localStorage
          ? localStorage.getItem("preferredLanguage")
          : null;
        if (savedLang && (savedLang === "pt" || savedLang === "en")) {
          return savedLang;
        }

        const timezone = Intl.DateTimeFormat().resolvedOptions().timeZone;
        const portugueseTimezones = [
          "Europe/Lisbon",
          "Atlantic/Madeira",
          "Atlantic/Azores",
          "America/Sao_Paulo",
          "America/Fortaleza",
          "America/Recife",
          "America/Araguaina",
          "America/Maceio",
          "America/Bahia",
          "America/Campo_Grande",
          "America/Cuiaba",
          "America/Santarem",
          "America/Porto_Velho",
          "America/Boa_Vista",
          "America/Manaus",
          "America/Eirunepe",
          "America/Rio_Branco",
        ];

        if (portugueseTimezones.includes(timezone)) {
          return "pt";
        }

        const browserLang = navigator.language || navigator.userLanguage;
        if (browserLang.startsWith("pt")) {
          return "pt";
        }

        return "en";
      }

      // Função para definir idioma
      function setLanguage(lang) {
        currentLanguage = lang;

        if (window.localStorage) {
          localStorage.setItem("preferredLanguage", lang);
        }

        document.querySelectorAll("[data-text-pt]").forEach((element) => {
          const text = element.getAttribute(`data-text-${lang}`);
          if (text) {
            if (element.tagName === "INPUT") {
              element.placeholder = text;
            } else {
              // Altera o conteúdo de texto para SPANs e outros elementos
              element.innerHTML = text;
            }
          }
        });

        document
          .querySelectorAll("[data-placeholder-pt]")
          .forEach((element) => {
            const placeholder = element.getAttribute(
              `data-placeholder-${lang}`
            );
            if (placeholder) {
              element.placeholder = placeholder;
            }
          });

        document.querySelectorAll(".lang-btn").forEach((btn) => {
          btn.classList.remove("active");
        });
        document.getElementById(`btn-${lang}`).classList.add("active");

        document.documentElement.lang = lang === "pt" ? "pt-BR" : "en";

        // Reload update bar with new language
        loadRecentUpdates();
      }

      // Funções de instalação
      function abrirHydraSteamRIP() {
        // URL da fonte SteamRIP
        window.open(
          "hydralauncher://install-source?urls=https://hydralinks.pages.dev/sources/steamrip.json"
        );
      }

      function abrirHydraFitGirl() {
        // URL da fonte FitGirl
        window.open(
          "hydralauncher://install-source?urls=https://hydralinks.cloud/sources/fitgirl.json"
        );
      }

      function abrirHydra() {
        // *** IMPORTANTE: Mude este URL para o seu arquivo .json principal! ***
        window.open(
          "hydralauncher://install-source?urls=https://hydralinks.cloud/sources/onlinefix.json"
        );
      }

      function abrirHydraVR() {
        // *** IMPORTANTE: Mude este URL para o seu arquivo .json VR! ***
        window.open(
          "hydralauncher://install-source?urls=https://hydralinks.cloud/sources/xatab.json"
        );
      }

      function pedidopraFonte() {
        // *** IMPORTANTE: Mude este URL para o seu link de formulário de pedidos! ***
        window.open(
          "hydralauncher://install-source?urls=https://hydralinks.cloud/sources/gog.json"
        );
      }

      // Inicialização
      document.addEventListener("DOMContentLoaded", () => {
        document
          .getElementById("btn-pt")
          .addEventListener("click", () => setLanguage("pt"));
        document
          .getElementById("btn-en")
          .addEventListener("click", () => setLanguage("en"));

        setLanguage(detectLanguage());

        // Load update bar
        loadRecentUpdates();
      });
    </script>
  </body>
</html>
